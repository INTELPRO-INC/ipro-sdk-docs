---
layout: default
title: FAQ - IPRO SDK
lang: en
---

<section class="page-header-section">
    <div class="container">
        <h1 class="page-title">❓ Frequently Asked Questions</h1>
        <p class="page-subtitle">Quick solutions for common development issues</p>
    </div>
</section>

<section class="faq-section">
    <div class="container">
        <!-- FAQ Categories Navigation -->
        <div class="faq-categories">
            <button class="faq-category-btn active" data-category="all">
                <i class="fas fa-list"></i> All
            </button>
            <button class="faq-category-btn" data-category="build">
                <i class="fas fa-hammer"></i> Build
            </button>
            <button class="faq-category-btn" data-category="ble">
                <i class="fas fa-bluetooth-b"></i> BLE
            </button>
            <button class="faq-category-btn" data-category="rf">
                <i class="fas fa-broadcast-tower"></i> RF
            </button>
            <button class="faq-category-btn" data-category="debug">
                <i class="fas fa-bug"></i> Debug
            </button>
            <button class="faq-category-btn" data-category="rtos">
                <i class="fas fa-microchip"></i> RTOS
            </button>
        </div>

        <!-- Search Box -->
        <div class="faq-search">
            <i class="fas fa-search"></i>
            <input type="text" id="faq-search-input" placeholder="Search questions...">
        </div>

        <!-- FAQ Items -->
        <div class="faq-list">
            
            <!-- Build Category -->
            <div class="faq-item" data-category="build">
                <div class="faq-question">
                    <span class="faq-badge build">Build</span>
                    <h3>Getting "toolchain not found" error during compilation?</h3>
                    <i class="fas fa-chevron-down"></i>
                </div>
                <div class="faq-answer">
                    <p>Ensure the RISC-V toolchain is correctly installed and the path is set:</p>
                    <pre><code class="language-bash"># Check toolchain path
ls /opt/toolchain/riscv_ipro7/bin/

# If not found, set the correct CROSS_COMPILE path
export CROSS_COMPILE=/your/toolchain/path/bin/riscv64-unknown-elf-

# Or specify in the build command
cmake -DCROSS_COMPILE=/opt/toolchain/riscv_ipro7/bin/riscv64-unknown-elf- ...</code></pre>
                </div>
            </div>

            <div class="faq-item" data-category="build">
                <div class="faq-question">
                    <span class="faq-badge build">Build</span>
                    <h3>How to clean and rebuild from scratch?</h3>
                    <i class="fas fa-chevron-down"></i>
                </div>
                <div class="faq-answer">
                    <p>Delete the build directory and rebuild:</p>
                    <pre><code class="language-bash"># Clean build cache
rm -rf build/

# Rebuild
./build_freertos.sh ipro_ble_demo build

# Or using CMake
cmake -S . -B build -G "Ninja" ...
cmake --build build</code></pre>
                </div>
            </div>

            <div class="faq-item" data-category="build">
                <div class="faq-question">
                    <span class="faq-badge build">Build</span>
                    <h3>Flash or RAM space insufficient during compilation?</h3>
                    <i class="fas fa-chevron-down"></i>
                </div>
                <div class="faq-answer">
                    <p>Optimize through the following methods:</p>
                    <ol>
                        <li>Disable unnecessary features in <code>proj.conf</code></li>
                        <li>Use <code>-Os</code> optimization level</li>
                        <li>Check if unused components are being compiled</li>
                    </ol>
                    <pre><code class="language-bash"># Check module sizes
arm-none-eabi-size build/build_out/*.elf

# Detailed analysis
arm-none-eabi-nm --size-sort build/build_out/*.elf | tail -50</code></pre>
                </div>
            </div>

            <!-- BLE Category -->
            <div class="faq-item" data-category="ble">
                <div class="faq-question">
                    <span class="faq-badge ble">BLE</span>
                    <h3>Phone cannot discover the BLE device?</h3>
                    <i class="fas fa-chevron-down"></i>
                </div>
                <div class="faq-answer">
                    <p>Check the following items:</p>
                    <ol>
                        <li>Confirm Advertising is started</li>
                        <li>Verify Advertising Data is correctly configured</li>
                        <li>Ensure correct Service UUIDs are included</li>
                        <li>Check if RF is working properly</li>
                    </ol>
                    <pre><code class="language-c">// Ensure Advertising Data contains necessary information
// Flags: LE General Discoverable + BR/EDR Not Supported
uint8_t adv_data[] = {
    0x02, 0x01, 0x06,  // Flags
    0x03, 0x03, 0x4E, 0x18,  // Complete 16-bit Service UUID (ASCS)
    // ... other data
};</code></pre>
                </div>
            </div>

            <div class="faq-item" data-category="ble">
                <div class="faq-question">
                    <span class="faq-badge ble">BLE</span>
                    <h3>Disconnects immediately after connecting (Error 0x00A3)?</h3>
                    <i class="fas fa-chevron-down"></i>
                </div>
                <div class="faq-answer">
                    <p>Error 0x00A3 indicates connection terminated by remote. Possible causes:</p>
                    <ul>
                        <li>Connection parameters not accepted by peer</li>
                        <li>GATT services not properly configured</li>
                        <li>Security pairing failed</li>
                    </ul>
                    <pre><code class="language-c">// Check if connection parameters are within reasonable range
// Interval: 7.5ms ~ 4s
// Latency: 0 ~ 499
// Timeout: 100ms ~ 32s
struct gapc_conn_param param = {
    .intv_min = 24,   // 30ms
    .intv_max = 40,   // 50ms
    .latency = 0,
    .time_out = 500,  // 5s
};</code></pre>
                </div>
            </div>

            <div class="faq-item" data-category="ble">
                <div class="faq-question">
                    <span class="faq-badge ble">BLE</span>
                    <h3>LE Audio has noise or stuttering?</h3>
                    <i class="fas fa-chevron-down"></i>
                </div>
                <div class="faq-answer">
                    <p>Audio quality issues may come from:</p>
                    <ul>
                        <li>Improper ISO Interval configuration</li>
                        <li>LC3 codec parameter mismatch</li>
                        <li>Buffer underrun/overrun</li>
                        <li>RF interference or weak signal</li>
                    </ul>
                    <pre><code class="language-c">// Recommended LE Audio parameters
// 48kHz, 10ms frame duration
// SDU size: 120 bytes (48_4 config)
struct bap_unicast_config {
    .sampling_freq = 48000,
    .frame_duration = 10000,  // 10ms in us
    .octets_per_frame = 120,
};</code></pre>
                </div>
            </div>

            <div class="faq-item" data-category="ble">
                <div class="faq-question">
                    <span class="faq-badge ble">BLE</span>
                    <h3>Activity creation fails (Error 0x004B)?</h3>
                    <i class="fas fa-chevron-down"></i>
                </div>
                <div class="faq-answer">
                    <p>Error 0x004B (75) indicates resource conflict, usually due to incomplete Activity cleanup.</p>
                    <p><strong>Solution:</strong> Use the complete cleanup sequence:</p>
                    <pre><code class="language-c">// 1. Stop the Activity
gapm_activity_stop_cmd_t *stop_cmd = ke_msg_alloc(...);
stop_cmd->actv_idx = actv_idx;
ke_msg_send(stop_cmd);

// 2. In GAPM_ACTIVITY_STOPPED_IND handler, send delete command
gapm_activity_delete_cmd_t *del_cmd = ke_msg_alloc(...);
del_cmd->actv_idx = actv_idx;
ke_msg_send(del_cmd);

// 3. Reset activity index
actv_idx = GAP_INVALID_IDX;</code></pre>
                </div>
            </div>

            <div class="faq-item" data-category="ble">
                <div class="faq-question">
                    <span class="faq-badge ble">BLE</span>
                    <h3>Crash after executing le_test_stop?</h3>
                    <i class="fas fa-chevron-down"></i>
                </div>
                <div class="faq-answer">
                    <p>This is because CLI directly calls HCI command handler without properly managing the <code>nb_h2c_cmd_pkts</code> counter.</p>
                    <p><strong>Solution:</strong></p>
                    <pre><code class="language-bash"># Enable BLE_MFG mode in proj.conf
CONFIG_BLE_MFG=y</code></pre>
                    <p>This configuration prevents test commands from sending HCI Command Complete Events, avoiding counter overflow.</p>
                </div>
            </div>

            <!-- RF Category -->
            <div class="faq-item" data-category="rf">
                <div class="faq-question">
                    <span class="faq-badge rf">RF</span>
                    <h3>How to adjust CFO (Carrier Frequency Offset)?</h3>
                    <i class="fas fa-chevron-down"></i>
                </div>
                <div class="faq-answer">
                    <p>CFO issues usually have two causes:</p>
                    <ol>
                        <li><strong>rf_kcal not executed:</strong> Check RF_CAL_STATE_CTRL register</li>
                        <li><strong>XTAL frequency deviation:</strong> Adjust capcode</li>
                    </ol>
                    <pre><code class="language-c">// 1. Ensure calibration is enabled
tmpVal = BL_RD_REG(RF_BASE, RF_CAL_STATE_CTRL);
tmpVal = BL_SET_REG_BITS_VAL(tmpVal, RF_KCAL_STATE_EN, 0x1);
BL_WR_REG(RF_BASE, RF_CAL_STATE_CTRL, tmpVal);

// 2. Adjust XTAL capcode
// Negative CFO (frequency too low) → Decrease capcode
// Positive CFO (frequency too high) → Increase capcode
tmpVal = BL_RD_REG(AON_BASE, AON_XTAL_CFG2);
tmpVal = BL_SET_REG_BITS_VAL(tmpVal, AON_XTAL_HF_CAPCODE_IN_AON, 70);
tmpVal = BL_SET_REG_BITS_VAL(tmpVal, AON_XTAL_HF_CAPCODE_OUT_AON, 70);
BL_WR_REG(AON_BASE, AON_XTAL_CFG2, tmpVal);</code></pre>
                </div>
            </div>

            <div class="faq-item" data-category="rf">
                <div class="faq-question">
                    <span class="faq-badge rf">RF</span>
                    <h3>How to configure TX Power?</h3>
                    <i class="fas fa-chevron-down"></i>
                </div>
                <div class="faq-answer">
                    <p>IPRO7 supports TX Power range from -20dBm to +10dBm:</p>
                    <pre><code class="language-c">// Using CLI
// rf_set_pwr <power_level>
// power_level: 0~15 corresponds to different power levels

// Or in code
rf_set_tx_power(power_level);

// Power Level Reference Table
// 0: -20dBm
// 4: -10dBm
// 8: 0dBm
// 12: +5dBm
// 15: +10dBm</code></pre>
                </div>
            </div>

            <div class="faq-item" data-category="rf">
                <div class="faq-question">
                    <span class="faq-badge rf">RF</span>
                    <h3>RF calibration failed or abnormal values?</h3>
                    <i class="fas fa-chevron-down"></i>
                </div>
                <div class="faq-answer">
                    <p>RF calibration includes four steps, each must complete successfully:</p>
                    <ul>
                        <li><strong>rf_acal:</strong> VCO amplitude calibration</li>
                        <li><strong>rf_kcal:</strong> LO frequency calibration</li>
                        <li><strong>rf_roscal:</strong> RX DC offset calibration</li>
                        <li><strong>rf_rccal:</strong> RBB filter RC calibration</li>
                    </ul>
                    <p>If you see boundary values like <code>rosdac_i = 63, rosdac_q = 1</code>, calibration may not have converged. Check:</p>
                    <ol>
                        <li>Hardware connections are correct</li>
                        <li>Power supply is stable</li>
                        <li>XTAL is oscillating properly</li>
                    </ol>
                </div>
            </div>

            <!-- Debug Category -->
            <div class="faq-item" data-category="debug">
                <div class="faq-question">
                    <span class="faq-badge debug">Debug</span>
                    <h3>How to enable Debug Log?</h3>
                    <i class="fas fa-chevron-down"></i>
                </div>
                <div class="faq-answer">
                    <p>Configure in <code>proj.conf</code>:</p>
                    <pre><code class="language-bash"># Enable Debug mode
CONFIG_CFG_DBG=y

# Enable BLE Library Debug
CONFIG_IPRO_BLE_LIB_DEBUG_ENABLE=y

# Set Log Level
CONFIG_LOG_DEFAULT_LEVEL=4  # DEBUG</code></pre>
                </div>
            </div>

            <div class="faq-item" data-category="debug">
                <div class="faq-question">
                    <span class="faq-badge debug">Debug</span>
                    <h3>How to use GDB for debugging?</h3>
                    <i class="fas fa-chevron-down"></i>
                </div>
                <div class="faq-answer">
                    <p>Use OpenOCD + GDB for hardware debugging:</p>
                    <pre><code class="language-bash"># 1. Start OpenOCD
openocd -f apps/ipro_blecontroller_test/fpga.cfg

# 2. In another terminal, connect GDB
riscv64-unknown-elf-gdb build/build_out/ipro_blecontroller_test.elf

# 3. GDB commands
(gdb) target remote localhost:3333
(gdb) load
(gdb) break main
(gdb) continue</code></pre>
                </div>
            </div>

            <div class="faq-item" data-category="debug">
                <div class="faq-question">
                    <span class="faq-badge debug">Debug</span>
                    <h3>How to analyze Hard Fault?</h3>
                    <i class="fas fa-chevron-down"></i>
                </div>
                <div class="faq-answer">
                    <p>Hard Fault is usually caused by:</p>
                    <ul>
                        <li>Null pointer access</li>
                        <li>Stack overflow</li>
                        <li>Unaligned memory access</li>
                        <li>Illegal instruction</li>
                    </ul>
                    <pre><code class="language-bash"># Use addr2line to parse backtrace
riscv64-unknown-elf-addr2line -e build/build_out/app.elf 0x12345678

# Or use the provided tool
python tools/parse_backtrace.py build/build_out/app.elf 0x12345678</code></pre>
                </div>
            </div>

            <!-- RTOS Category -->
            <div class="faq-item" data-category="rtos">
                <div class="faq-question">
                    <span class="faq-badge rtos">RTOS</span>
                    <h3>How to solve Task Stack Overflow?</h3>
                    <i class="fas fa-chevron-down"></i>
                </div>
                <div class="faq-answer">
                    <p>Increase the Task stack size:</p>
                    <pre><code class="language-c">// FreeRTOS
xTaskCreate(
    task_function,
    "TaskName",
    2048,  // Increase Stack size (words)
    NULL,
    tskIDLE_PRIORITY + 1,
    &task_handle
);

// Zephyr
K_THREAD_STACK_DEFINE(my_stack, 4096);  // Increase to 4KB</code></pre>
                    <p>You can also enable Stack monitoring to track usage.</p>
                </div>
            </div>

            <div class="faq-item" data-category="rtos">
                <div class="faq-question">
                    <span class="faq-badge rtos">RTOS</span>
                    <h3>FreeRTOS vs Zephyr - which to choose?</h3>
                    <i class="fas fa-chevron-down"></i>
                </div>
                <div class="faq-answer">
                    <table class="comparison-table">
                        <thead>
                            <tr>
                                <th>Feature</th>
                                <th>FreeRTOS</th>
                                <th>Zephyr</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Learning Curve</td>
                                <td>Lower</td>
                                <td>Higher</td>
                            </tr>
                            <tr>
                                <td>Build Time</td>
                                <td>Longer</td>
                                <td>~30 seconds</td>
                            </tr>
                            <tr>
                                <td>Device Drivers</td>
                                <td>Manual Integration</td>
                                <td>Device Tree</td>
                            </tr>
                            <tr>
                                <td>Memory Footprint</td>
                                <td>Smaller</td>
                                <td>Larger</td>
                            </tr>
                            <tr>
                                <td>BLE Support</td>
                                <td>Complete</td>
                                <td>In Development</td>
                            </tr>
                        </tbody>
                    </table>
                    <p><strong>Recommendation:</strong> Choose FreeRTOS for BLE applications, Zephyr for modern development experience.</p>
                </div>
            </div>

        </div>
    </div>
</section>

<script>
document.addEventListener('DOMContentLoaded', function() {
    // FAQ Accordion
    const faqItems = document.querySelectorAll('.faq-item');
    faqItems.forEach(item => {
        const question = item.querySelector('.faq-question');
        question.addEventListener('click', () => {
            item.classList.toggle('open');
        });
    });

    // Category Filter
    const categoryBtns = document.querySelectorAll('.faq-category-btn');
    categoryBtns.forEach(btn => {
        btn.addEventListener('click', () => {
            categoryBtns.forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            
            const category = btn.dataset.category;
            faqItems.forEach(item => {
                if (category === 'all' || item.dataset.category === category) {
                    item.classList.remove('hidden');
                } else {
                    item.classList.add('hidden');
                }
            });
        });
    });

    // Search
    const searchInput = document.getElementById('faq-search-input');
    searchInput.addEventListener('input', (e) => {
        const query = e.target.value.toLowerCase();
        faqItems.forEach(item => {
            const text = item.textContent.toLowerCase();
            if (text.includes(query)) {
                item.classList.remove('hidden');
            } else {
                item.classList.add('hidden');
            }
        });
        
        // Reset category filter
        categoryBtns.forEach(b => b.classList.remove('active'));
        document.querySelector('[data-category="all"]').classList.add('active');
    });
});
</script>
