---
layout: default
title: FAQ - IPRO SDK
lang: en
---

<section class="page-header-section">
    <div class="container">
        <h1 class="page-title">Frequently Asked Questions</h1>
        <p class="page-subtitle">Quick solutions for common development issues</p>
    </div>
</section>

<section class="faq-section">
    <div class="container">
        <!-- FAQ Categories Navigation -->
        <div class="faq-categories">
            <button class="faq-category-btn active" data-category="all">
                <i class="fas fa-list"></i> All
            </button>
            <button class="faq-category-btn" data-category="build">
                <i class="fas fa-hammer"></i> Build
            </button>
            <button class="faq-category-btn" data-category="ble">
                <i class="fas fa-bluetooth-b"></i> BLE
            </button>
            <button class="faq-category-btn" data-category="rf">
                <i class="fas fa-broadcast-tower"></i> RF
            </button>
            <button class="faq-category-btn" data-category="debug">
                <i class="fas fa-bug"></i> Debug
            </button>
            <button class="faq-category-btn" data-category="rtos">
                <i class="fas fa-microchip"></i> RTOS
            </button>
        </div>

        <!-- Search Box -->
        <div class="faq-search">
            <i class="fas fa-search"></i>
            <input type="text" id="faq-search-input" placeholder="Search questions...">
        </div>

        <!-- FAQ Items -->
        <div class="faq-list">

            <!-- Build Category -->
            <div class="faq-item" data-category="build">
                <div class="faq-question">
                    <span class="faq-badge build">Build</span>
                    <h3>What is the difference between make -C apps/&lt;project&gt; and build_freertos.sh?</h3>
                    <i class="fas fa-chevron-down"></i>
                </div>
                <div class="faq-answer">
                    <p>Both are functionally equivalent. <code>make -C apps/&lt;project&gt;</code> is the recommended method -- it internally delegates to the <code>project.build</code> script. <code>build_freertos.sh</code> is the legacy build entry point.</p>
                    <pre><code class="language-bash"># Recommended
make -C apps/ipro_ble_remote

# Legacy (still works)
./build_freertos.sh ipro_ble_remote build

# Clean build
make -C apps/ipro_ble_remote clean</code></pre>
                    <p>Build output is at <code>apps/&lt;project&gt;/build/build_out/</code>. Binary names include a chip suffix (e.g., <code>ipro_ble_remote_IPRO7.bin</code>).</p>
                </div>
            </div>

            <div class="faq-item" data-category="build">
                <div class="faq-question">
                    <span class="faq-badge build">Build</span>
                    <h3>What is the .config file format? How to set CONFIG_* variables?</h3>
                    <i class="fas fa-chevron-down"></i>
                </div>
                <div class="faq-answer">
                    <p><code>.config</code> uses Linux Kernel Kconfig format. Each application has its own <code>.config</code>, and the build system auto-generates <code>generated/autoconf.h</code> from it.</p>
                    <pre><code class="language-bash"># Basic format
CONFIG_IPRO7=y                          # Boolean: enabled
CONFIG_CPU_ID="intelpro_ipro7"          # String value
CONFIG_FREERTOS_SUPPORT=y               # RTOS selection
CONFIG_BLUETOOTH_LE_ENABLE=y            # BLE enable
# CONFIG_LWIP is not set                # Boolean: disabled</code></pre>
                    <p>After modifying <code>.config</code>, rebuild is required. Common CONFIG variables include SoC selection (<code>CONFIG_IPRO7</code>), RTOS (<code>CONFIG_FREERTOS_SUPPORT</code>), and component enables (<code>CONFIG_BLUETOOTH_LE_ENABLE</code>, <code>CONFIG_LWIP</code>, <code>CONFIG_MBEDTLS</code>, etc.).</p>
                </div>
            </div>

            <div class="faq-item" data-category="build">
                <div class="faq-question">
                    <span class="faq-badge build">Build</span>
                    <h3>Getting "toolchain not found" error during compilation?</h3>
                    <i class="fas fa-chevron-down"></i>
                </div>
                <div class="faq-answer">
                    <p>Ensure the RISC-V toolchain is correctly installed and the path is set:</p>
                    <pre><code class="language-bash"># Check toolchain path
ls /opt/toolchain/riscv_ipro7/bin/

# If not found, set the correct CROSS_COMPILE path
export CROSS_COMPILE=/your/toolchain/path/bin/riscv64-unknown-elf-

# Or specify in the build command
cmake -DCROSS_COMPILE=/opt/toolchain/riscv_ipro7/bin/riscv64-unknown-elf- ...</code></pre>
                    <p>Make sure <code>CONFIG_CPU_ID</code> is correctly set in <code>.config</code>, otherwise the toolchain cannot detect architecture flags.</p>
                </div>
            </div>

            <div class="faq-item" data-category="build">
                <div class="faq-question">
                    <span class="faq-badge build">Build</span>
                    <h3>Flash or RAM space insufficient during compilation?</h3>
                    <i class="fas fa-chevron-down"></i>
                </div>
                <div class="faq-answer">
                    <p>Optimize through the following methods:</p>
                    <ol>
                        <li>Disable unnecessary features in <code>.config</code></li>
                        <li>Use <code>-Os</code> optimization level</li>
                        <li>Check if unused components are being compiled</li>
                    </ol>
                    <pre><code class="language-bash"># Check module sizes
riscv64-unknown-elf-size build/build_out/*.elf

# Detailed analysis
riscv64-unknown-elf-nm --size-sort build/build_out/*.elf | tail -50</code></pre>
                </div>
            </div>

            <!-- BLE Category -->
            <div class="faq-item" data-category="ble">
                <div class="faq-question">
                    <span class="faq-badge ble">BLE</span>
                    <h3>How to choose the right BLE Controller linkN variant?</h3>
                    <i class="fas fa-chevron-down"></i>
                </div>
                <div class="faq-answer">
                    <p>Choose the appropriate Controller variant based on your application needs:</p>
                    <div class="table-wrapper">
                        <table>
                            <thead>
                                <tr><th>Variant</th><th>Links</th><th>Description</th><th>Use Case</th></tr>
                            </thead>
                            <tbody>
                                <tr><td><code>link1_periph</code></td><td>1</td><td>Peripheral only</td><td>Smallest footprint simple peripheral</td></tr>
                                <tr><td><code>link1</code></td><td>1</td><td>Central + Peripheral</td><td>Single connection apps</td></tr>
                                <tr><td><code>link2</code></td><td>2</td><td>Central + Peripheral</td><td>Common apps (recommended default)</td></tr>
                                <tr><td><code>link4</code></td><td>4</td><td>Multi-connection</td><td>Gateways, multi-device management</td></tr>
                                <tr><td><code>link8</code></td><td>8</td><td>Multi-connection</td><td>Large multi-connection scenarios</td></tr>
                                <tr><td><code>link1_leaudio</code></td><td>1</td><td>BLE 5.2 + LE Audio</td><td>Simple LE Audio headset</td></tr>
                                <tr><td><code>link2_leaudio</code></td><td>2</td><td>BLE 5.2 + LE Audio</td><td>TWS earbuds</td></tr>
                                <tr><td><code>link1_leaudio_53_54</code></td><td>1</td><td>BLE 5.4 + LE Audio</td><td>Latest LE Audio features</td></tr>
                                <tr><td><code>link2_leaudio_53_54</code></td><td>2</td><td>BLE 5.4 + LE Audio</td><td>Latest TWS features</td></tr>
                            </tbody>
                        </table>
                    </div>
                    <p>The connection model uses a unified pool -- any connection can be either Central or Peripheral role, freely combined.</p>
                </div>
            </div>

            <div class="faq-item" data-category="ble">
                <div class="faq-question">
                    <span class="faq-badge ble">BLE</span>
                    <h3>How to use prebuilt Controller libraries? What is build_all_prebuilts.sh?</h3>
                    <i class="fas fa-chevron-down"></i>
                </div>
                <div class="faq-answer">
                    <p>The BLE Controller is provided as prebuilt static libraries (<code>.a</code>) in <code>components/wireless/bluetooth/btblecontroller/</code>.</p>
                    <p>To rebuild prebuilt libraries (e.g., after updating Controller settings), use <code>build_all_prebuilts.sh</code>:</p>
                    <pre><code class="language-bash"># Rebuild specific variant
components/wireless/bluetooth/build_all_prebuilts.sh link2

# Rebuild all variants
components/wireless/bluetooth/build_all_prebuilts.sh all</code></pre>
                    <p>The script automatically uses template apps (<code>ipro_ble_remote</code> for base, <code>ipro_le_audio_headset</code> for LE Audio), strips debug sections after build, and writes version metadata.</p>
                    <div class="warning-box">
                        <h4>Important</h4>
                        <p><code>CONFIG_BLE_FORCE_SOURCE_BUILD</code> cannot be used in release builds. Release builds must use prebuilt libraries.</p>
                    </div>
                </div>
            </div>

            <div class="faq-item" data-category="ble">
                <div class="faq-question">
                    <span class="faq-badge ble">BLE</span>
                    <h3>How does multi-connection work with different role combinations?</h3>
                    <i class="fas fa-chevron-down"></i>
                </div>
                <div class="faq-answer">
                    <p>IPRO SDK uses a unified connection pool model. For example with <code>link4</code>, the 4 connections can be any Central/Peripheral combination:</p>
                    <ul>
                        <li>4 Peripherals (passive connections)</li>
                        <li>4 Centrals (active connections)</li>
                        <li>2 Central + 2 Peripheral (mixed)</li>
                        <li>Any other combination within the total connection limit</li>
                    </ul>
                    <p>A device can simultaneously advertise and scan, enabling Relay, Mesh-like topologies, and other advanced scenarios.</p>
                </div>
            </div>

            <div class="faq-item" data-category="ble">
                <div class="faq-question">
                    <span class="faq-badge ble">BLE</span>
                    <h3>Phone cannot discover the BLE device?</h3>
                    <i class="fas fa-chevron-down"></i>
                </div>
                <div class="faq-answer">
                    <p>Check the following items:</p>
                    <ol>
                        <li>Confirm Advertising is started</li>
                        <li>Verify Advertising Data is correctly configured</li>
                        <li>Ensure correct Service UUIDs are included</li>
                        <li>Check if RF is working properly</li>
                    </ol>
                    <pre><code class="language-c">// Ensure Advertising Data contains necessary information
static const struct bt_data ad[] = {
    BT_DATA_BYTES(BT_DATA_FLAGS,
                  BT_LE_AD_GENERAL | BT_LE_AD_NO_BREDR),
    BT_DATA_BYTES(BT_DATA_NAME_COMPLETE, 'I','P','R','O'),
};

bt_le_adv_start(BT_LE_ADV_CONN, ad, ARRAY_SIZE(ad),
                NULL, 0);</code></pre>
                </div>
            </div>

            <div class="faq-item" data-category="ble">
                <div class="faq-question">
                    <span class="faq-badge ble">BLE</span>
                    <h3>LE Audio has noise or stuttering?</h3>
                    <i class="fas fa-chevron-down"></i>
                </div>
                <div class="faq-answer">
                    <p>Audio quality issues may come from:</p>
                    <ul>
                        <li>Improper ISO Interval configuration</li>
                        <li>LC3 codec parameter mismatch</li>
                        <li>Buffer underrun/overrun</li>
                        <li>RF interference or weak signal</li>
                    </ul>
                    <pre><code class="language-c">// Recommended LE Audio parameters
// 48kHz, 10ms frame duration
// SDU size: 120 bytes (48_4 config)
struct bap_unicast_config {
    .sampling_freq = 48000,
    .frame_duration = 10000,  // 10ms in us
    .octets_per_frame = 120,
};</code></pre>
                </div>
            </div>

            <!-- Debug / Serial Category -->
            <div class="faq-item" data-category="debug">
                <div class="faq-question">
                    <span class="faq-badge debug">Debug</span>
                    <h3>What is the difference between cu.* and tty.* serial ports on macOS?</h3>
                    <i class="fas fa-chevron-down"></i>
                </div>
                <div class="faq-answer">
                    <p>On macOS, each serial device has two device nodes:</p>
                    <ul>
                        <li><code>/dev/cu.*</code> (Calling Unit) - <strong>You must use this device</strong>. Does not wait for DCD signal, opens immediately.</li>
                        <li><code>/dev/tty.*</code> (Teletype) - Waits for DCD signal, causing the program to hang.</li>
                    </ul>
                    <pre><code class="language-bash"># Correct
python3 tools/serial_monitor.py /dev/cu.usbserial-2120

# Wrong (will hang)
python3 tools/serial_monitor.py /dev/tty.usbserial-2120</code></pre>
                </div>
            </div>

            <div class="faq-item" data-category="debug">
                <div class="faq-question">
                    <span class="faq-badge debug">Debug</span>
                    <h3>Getting "Resource busy" error on serial port?</h3>
                    <i class="fas fa-chevron-down"></i>
                </div>
                <div class="faq-answer">
                    <p>This is usually because another program (including <code>stty</code>) is holding the serial port. Solutions:</p>
                    <ol>
                        <li>Check and close programs using the port: <code>lsof /dev/cu.usbserial-2120</code></li>
                        <li>Avoid using <code>stty -f</code>, which keeps the port busy</li>
                        <li>Use <code>tools/serial_monitor.py</code> instead of <code>cat</code> or <code>screen</code></li>
                    </ol>
                    <p><code>serial_monitor.py</code> uses Python3 termios with <code>O_NOCTTY | O_NONBLOCK</code> flags, requiring no pyserial dependency.</p>
                </div>
            </div>

            <div class="faq-item" data-category="debug">
                <div class="faq-question">
                    <span class="faq-badge debug">Debug</span>
                    <h3>How to enable Debug Log?</h3>
                    <i class="fas fa-chevron-down"></i>
                </div>
                <div class="faq-answer">
                    <p>Configure in <code>.config</code>:</p>
                    <pre><code class="language-bash"># Enable Debug mode
CONFIG_CFG_DBG=y

# Enable BLE Library Debug
CONFIG_IPRO_BLE_LIB_DEBUG_ENABLE=y

# Set Log Level
CONFIG_LOG_DEFAULT_LEVEL=4  # DEBUG</code></pre>
                </div>
            </div>

            <div class="faq-item" data-category="debug">
                <div class="faq-question">
                    <span class="faq-badge debug">Debug</span>
                    <h3>How to analyze Hard Fault?</h3>
                    <i class="fas fa-chevron-down"></i>
                </div>
                <div class="faq-answer">
                    <p>Hard Fault is usually caused by:</p>
                    <ul>
                        <li>Null pointer access</li>
                        <li>Stack overflow</li>
                        <li>Unaligned memory access</li>
                        <li>Illegal instruction</li>
                    </ul>
                    <pre><code class="language-bash"># Use addr2line to parse backtrace
riscv64-unknown-elf-addr2line -e build/build_out/app.elf 0x12345678</code></pre>
                </div>
            </div>

            <!-- RF Category -->
            <div class="faq-item" data-category="rf">
                <div class="faq-question">
                    <span class="faq-badge rf">RF</span>
                    <h3>How to adjust CFO (Carrier Frequency Offset)?</h3>
                    <i class="fas fa-chevron-down"></i>
                </div>
                <div class="faq-answer">
                    <p>CFO issues usually have two causes:</p>
                    <ol>
                        <li><strong>rf_kcal not executed:</strong> Check RF_CAL_STATE_CTRL register</li>
                        <li><strong>XTAL frequency deviation:</strong> Adjust capcode</li>
                    </ol>
                    <pre><code class="language-c">// Adjust XTAL capcode
// Negative CFO (frequency too low): Decrease capcode
// Positive CFO (frequency too high): Increase capcode
tmpVal = BL_RD_REG(AON_BASE, AON_XTAL_CFG2);
tmpVal = BL_SET_REG_BITS_VAL(tmpVal, AON_XTAL_HF_CAPCODE_IN_AON, 70);
tmpVal = BL_SET_REG_BITS_VAL(tmpVal, AON_XTAL_HF_CAPCODE_OUT_AON, 70);
BL_WR_REG(AON_BASE, AON_XTAL_CFG2, tmpVal);</code></pre>
                </div>
            </div>

            <div class="faq-item" data-category="rf">
                <div class="faq-question">
                    <span class="faq-badge rf">RF</span>
                    <h3>How to configure TX Power?</h3>
                    <i class="fas fa-chevron-down"></i>
                </div>
                <div class="faq-answer">
                    <p>IPRO7 supports TX Power range from -20dBm to +10dBm:</p>
                    <pre><code class="language-c">// Power Level Reference Table
// 0: -20dBm    4: -10dBm
// 8: 0dBm     12: +5dBm    15: +10dBm

// CLI
// rf_set_pwr &lt;power_level&gt;

// In code
rf_set_tx_power(power_level);</code></pre>
                </div>
            </div>

            <!-- RTOS Category -->
            <div class="faq-item" data-category="rtos">
                <div class="faq-question">
                    <span class="faq-badge rtos">RTOS</span>
                    <h3>FreeRTOS vs Zephyr - which to choose?</h3>
                    <i class="fas fa-chevron-down"></i>
                </div>
                <div class="faq-answer">
                    <table class="comparison-table">
                        <thead>
                            <tr>
                                <th>Feature</th>
                                <th>FreeRTOS</th>
                                <th>Zephyr</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr><td>Learning Curve</td><td>Lower</td><td>Higher</td></tr>
                            <tr><td>BLE Support</td><td>Complete (production-ready)</td><td>Experimental</td></tr>
                            <tr><td>Memory Footprint</td><td>Smaller</td><td>Larger</td></tr>
                            <tr><td>Device Drivers</td><td>Manual Integration</td><td>Device Tree</td></tr>
                            <tr><td>Build Time</td><td>Longer</td><td>~30 seconds</td></tr>
                        </tbody>
                    </table>
                    <p><strong>Recommendation:</strong> Choose FreeRTOS for BLE applications and production products. Zephyr is currently experimental, suitable for scenarios requiring Device Tree and modern development experience, but not recommended for production.</p>
                    <pre><code class="language-bash"># FreeRTOS build (recommended)
make -C apps/ipro_ble_remote

# Zephyr build (experimental)
./tools/zephyr/build.sh -a &lt;app&gt; -b ipro7_fpga -c</code></pre>
                </div>
            </div>

            <div class="faq-item" data-category="rtos">
                <div class="faq-question">
                    <span class="faq-badge rtos">RTOS</span>
                    <h3>How to solve Task Stack Overflow?</h3>
                    <i class="fas fa-chevron-down"></i>
                </div>
                <div class="faq-answer">
                    <p>Increase the Task stack size:</p>
                    <pre><code class="language-c">// FreeRTOS
xTaskCreate(
    task_function,
    "TaskName",
    2048,  // Increase Stack size (words)
    NULL,
    tskIDLE_PRIORITY + 1,
    &task_handle
);</code></pre>
                    <p>You can also enable Stack monitoring to track usage.</p>
                </div>
            </div>

        </div>
    </div>
</section>

<script>
document.addEventListener('DOMContentLoaded', function() {
    // FAQ Accordion
    const faqItems = document.querySelectorAll('.faq-item');
    faqItems.forEach(item => {
        const question = item.querySelector('.faq-question');
        question.addEventListener('click', () => {
            item.classList.toggle('open');
        });
    });

    // Category Filter
    const categoryBtns = document.querySelectorAll('.faq-category-btn');
    categoryBtns.forEach(btn => {
        btn.addEventListener('click', () => {
            categoryBtns.forEach(b => b.classList.remove('active'));
            btn.classList.add('active');

            const category = btn.dataset.category;
            faqItems.forEach(item => {
                if (category === 'all' || item.dataset.category === category) {
                    item.classList.remove('hidden');
                } else {
                    item.classList.add('hidden');
                }
            });
        });
    });

    // Search
    const searchInput = document.getElementById('faq-search-input');
    searchInput.addEventListener('input', (e) => {
        const query = e.target.value.toLowerCase();
        faqItems.forEach(item => {
            const text = item.textContent.toLowerCase();
            if (text.includes(query)) {
                item.classList.remove('hidden');
            } else {
                item.classList.add('hidden');
            }
        });

        // Reset category filter
        categoryBtns.forEach(b => b.classList.remove('active'));
        document.querySelector('[data-category="all"]').classList.add('active');
    });
});
</script>
